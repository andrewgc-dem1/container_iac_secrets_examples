{
  "vulnerabilities": {
    "descriptor": {
      "configuration": "",
      "db": {
        "built": "2023-06-29T01:34:06Z",
        "checksum": "sha256:a70a066cbe03743a09df8245fb7613133efb233e1bc3d8aae9f9b4cb6078a70a",
        "error": null,
        "location": "/var/folders/2v/z_0jd7gn30qcym54rz_z2__m0000gq/T/veracode_cli_cache/5",
        "schemaVersion": 5
      },
      "name": "grype",
      "version": "[not provided]"
    },
    "distro": {
      "idLike": null,
      "name": "",
      "version": ""
    },
    "matches": [],
    "source": {
      "target": "./insecure-test/iac/helm",
      "type": "directory"
    }
  },
  "secrets": {
    "ArtifactName": "insecure-test/iac/helm",
    "ArtifactType": "filesystem",
    "Metadata": {
      "ImageConfig": {
        "architecture": "",
        "config": {},
        "created": "0001-01-01T00:00:00Z",
        "os": "",
        "rootfs": {
          "diff_ids": null,
          "type": ""
        }
      }
    },
    "SchemaVersion": 2
  },
  "configs": {
    "ArtifactName": "insecure-test/iac/helm",
    "ArtifactType": "filesystem",
    "Metadata": {
      "ImageConfig": {
        "architecture": "",
        "config": {},
        "created": "0001-01-01T00:00:00Z",
        "os": "",
        "rootfs": {
          "diff_ids": null,
          "type": ""
        }
      }
    },
    "Results": [
      {
        "Class": "config",
        "MisconfSummary": {
          "Exceptions": 0,
          "Failures": 0,
          "Successes": 79
        },
        "Target": "templates/configmap.yaml",
        "Type": "helm"
      },
      {
        "Class": "config",
        "MisconfSummary": {
          "Exceptions": 0,
          "Failures": 0,
          "Successes": 79
        },
        "Target": "templates/service.yaml",
        "Type": "helm"
      },
      {
        "Class": "config",
        "MisconfSummary": {
          "Exceptions": 0,
          "Failures": 12,
          "Successes": 67
        },
        "Misconfigurations": [
          {
            "AVDID": "AVD-KSV-0001",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
            "ID": "KSV001",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should set 'securityContext.allowPrivilegeEscalation' to false",
            "Namespace": "builtin.kubernetes.KSV001",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
            "Query": "data.builtin.kubernetes.KSV001.deny",
            "References": [
              "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
              "https://avd.aquasec.com/misconfig/ksv001"
            ],
            "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
            "Severity": "MEDIUM",
            "Status": "FAIL",
            "Title": "Process can elevate its own privileges",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0003",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
            "ID": "KSV003",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should add 'ALL' to 'securityContext.capabilities.drop'",
            "Namespace": "builtin.kubernetes.KSV003",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
            "Query": "data.builtin.kubernetes.KSV003.deny",
            "References": [
              "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
              "https://avd.aquasec.com/misconfig/ksv003"
            ],
            "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "Default capabilities not dropped",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0011",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
            "ID": "KSV011",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should set 'resources.limits.cpu'",
            "Namespace": "builtin.kubernetes.KSV011",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
            "Query": "data.builtin.kubernetes.KSV011.deny",
            "References": [
              "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
              "https://avd.aquasec.com/misconfig/ksv011"
            ],
            "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "CPU not limited",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0012",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.",
            "ID": "KSV012",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should set 'securityContext.runAsNonRoot' to true",
            "Namespace": "builtin.kubernetes.KSV012",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
            "Query": "data.builtin.kubernetes.KSV012.deny",
            "References": [
              "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
              "https://avd.aquasec.com/misconfig/ksv012"
            ],
            "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
            "Severity": "MEDIUM",
            "Status": "FAIL",
            "Title": "Runs as root user",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0014",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
            "ID": "KSV014",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should set 'securityContext.readOnlyRootFilesystem' to true",
            "Namespace": "builtin.kubernetes.KSV014",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
            "Query": "data.builtin.kubernetes.KSV014.deny",
            "References": [
              "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
              "https://avd.aquasec.com/misconfig/ksv014"
            ],
            "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "Root file system is not read-only",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0015",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
            "ID": "KSV015",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should set 'resources.requests.cpu'",
            "Namespace": "builtin.kubernetes.KSV015",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
            "Query": "data.builtin.kubernetes.KSV015.deny",
            "References": [
              "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
              "https://avd.aquasec.com/misconfig/ksv015"
            ],
            "Resolution": "Set 'containers[].resources.requests.cpu'.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "CPU requests not specified",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0016",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
            "ID": "KSV016",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should set 'resources.requests.memory'",
            "Namespace": "builtin.kubernetes.KSV016",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
            "Query": "data.builtin.kubernetes.KSV016.deny",
            "References": [
              "https://kubesec.io/basics/containers-resources-limits-memory/",
              "https://avd.aquasec.com/misconfig/ksv016"
            ],
            "Resolution": "Set 'containers[].resources.requests.memory'.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "Memory requests not specified",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0018",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
            "ID": "KSV018",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should set 'resources.limits.memory'",
            "Namespace": "builtin.kubernetes.KSV018",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
            "Query": "data.builtin.kubernetes.KSV018.deny",
            "References": [
              "https://kubesec.io/basics/containers-resources-limits-memory/",
              "https://avd.aquasec.com/misconfig/ksv018"
            ],
            "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "Memory not limited",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0020",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
            "ID": "KSV020",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should set 'securityContext.runAsUser' \u003e 10000",
            "Namespace": "builtin.kubernetes.KSV020",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
            "Query": "data.builtin.kubernetes.KSV020.deny",
            "References": [
              "https://kubesec.io/basics/containers-securitycontext-runasuser/",
              "https://avd.aquasec.com/misconfig/ksv020"
            ],
            "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "Runs with low user ID",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0021",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
            "ID": "KSV021",
            "Layer": {},
            "Message": "Container 'aerospike' of StatefulSet 'aerospike' should set 'securityContext.runAsGroup' \u003e 10000",
            "Namespace": "builtin.kubernetes.KSV021",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
            "Query": "data.builtin.kubernetes.KSV021.deny",
            "References": [
              "https://kubesec.io/basics/containers-securitycontext-runasuser/",
              "https://avd.aquasec.com/misconfig/ksv021"
            ],
            "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "Runs with low group ID",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0030",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "The RuntimeDefault/Localhost seccomp profile must be required, or allow specific additional profiles.",
            "ID": "KSV030",
            "Layer": {},
            "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
            "Namespace": "builtin.kubernetes.KSV030",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
            "Query": "data.builtin.kubernetes.KSV030.deny",
            "References": [
              "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
              "https://avd.aquasec.com/misconfig/ksv030"
            ],
            "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "Default Seccomp profile not set",
            "Type": "Helm Security Check"
          },
          {
            "AVDID": "AVD-KSV-0106",
            "CauseMetadata": {
              "Code": {
                "Lines": [
                  {
                    "Annotation": "",
                    "Content": "      - name: aerospike",
                    "FirstCause": true,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 28,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        image: \"aerospike/aerospike-server:4.5.0.5\"",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 29,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        imagePullPolicy: IfNotPresent",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 30,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 31,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 32,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        ports:",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 33,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3000",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 34,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "          name: clients",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": false,
                    "Number": 35,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "        - containerPort: 3002",
                    "FirstCause": false,
                    "IsCause": true,
                    "LastCause": true,
                    "Number": 36,
                    "Truncated": false
                  },
                  {
                    "Annotation": "",
                    "Content": "",
                    "FirstCause": false,
                    "IsCause": false,
                    "LastCause": false,
                    "Number": 37,
                    "Truncated": true
                  }
                ]
              },
              "EndLine": 50,
              "Provider": "Kubernetes",
              "Service": "general",
              "StartLine": 28
            },
            "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
            "ID": "KSV106",
            "Layer": {},
            "Message": "container should drop all",
            "Namespace": "builtin.kubernetes.KSV106",
            "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
            "Query": "data.builtin.kubernetes.KSV106.deny",
            "References": [
              "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
              "https://avd.aquasec.com/misconfig/ksv106"
            ],
            "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
            "Severity": "LOW",
            "Status": "FAIL",
            "Title": "Container capabilities must only include NET_BIND_SERVICE",
            "Type": "Helm Security Check"
          }
        ],
        "Target": "templates/statefulset.yaml",
        "Type": "helm"
      }
    ],
    "SchemaVersion": 2
  },
  "policy-results": [
    {
      "filename": "root",
      "namespace": "main",
      "successes": 6
    }
  ],
  "policy-passed": true
}